<h1>Preorder Online<button style="float:right" type="button" class="btn btn-primary" data-toggle="modal" data-target="#cartModal"
    (click)="calculateTotalPrice(null)">
    รถเข็น
  </button></h1>


<hr>

<div class="row" style="margin: 10px">

  <div class="card col-lg-6 col-md-6 col-sm-6 col-xs-6 mx-auto" style="padding: 15px;">
    <button class="btn btn-primary" type="button" (click)="changePage('preOrder')">
      จองสินค้า
    </button>
  </div>

  <div class="card col-lg-6 col-md-6 col-sm-6 col-xs-6 mx-auto" style="padding: 15px;">
    <button class="btn btn-primary" type="button" (click)="changePage('preStatus')">
      ตรวจสอบการจอง
    </button>
  </div>

</div>

<div *ngIf="showPage === 'preOrder'">

  <div class="row" style="margin: 10px; ">
    <div class="card col-lg-3 col-md-3 col-sm-3 col-xs-3 mx-auto" style="margin: 5px;" *ngFor="let item of allProduct; let i = index">
      <img class="card-img-top" style="margin-top: 15px; width: 100%; height: 200px;" [src]="getImgTobase64(item.p_img)"
        alt="Card image cap">
      <div class="card-body">
        <h6 class="card-title">ชื่อ : {{item.p_name}}</h6>
        <h6 class="card-title">ขนาด : {{item.p_size}}</h6>
        <h6 class="card-title">ไส้ : {{item.mixer}}</h6>
        <h6 class="card-title">ราคา : {{item.price}}</h6>
        <button class="btn btn-primary" type="button" data-toggle="modal" (click)="openModalAddTocart(item)">
          สั่งซื้อล่วงหน้า
        </button>
      </div>
    </div>
  </div>

  <div class="modal fade" id="addToCartModal" tabindex="-1" role="dialog" aria-labelledby="Modal" aria-hidden="true">
    <div class="modal-dialog modal-sm" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>

        </div>
        <div class="container">
          <div [formGroup]="preOrderForm">
            <div class="row">
              <div class="card" style="margin: 5px;" *ngFor="let item of selectProduct; let i = index">
                <img class="card-img-top" style="margin-top: 15px; width: 100%; height: 200px;" [src]="getImgTobase64(item.p_img)"
                  alt="Card image cap">
                <div class="card-body">
                  <h6 class="card-title">ชื่อ : {{item.p_name}}</h6>
                  <h6 class="card-title">ขนาด : {{item.p_size}}</h6>
                  <h6 class="card-title">ไส้ : {{item.mixer}}</h6>
                  <h6 class="card-title">ราคา : {{item.price}}บาท/ชิ้น</h6>

                  <div class="row">
                    <div class="col-4">
                      <h6>จำนวน</h6>
                    </div>
                    <div class="col-4">
                      <input type="number" class="form-control" formControlName="amount" (input)="checkDisableButtonOfAmount(item.price)">
                    </div>
                    <div class="col-4">
                      <h6>ชิ้น</h6>
                    </div>
                  </div>
                  <hr>
                  <h6 *ngIf="sumPrice" class="card-title">ราคาทั้งหมด : {{sumPrice}} บาท</h6>
                  <button class="btn btn-primary" style="width: 100%" type="submit" data-toggle="modal" (click)="addTocart(item)"
                    [disabled]="!invalidAmont">
                    เพิ่มลงรถเข็น
                  </button>
                </div>
              </div>
            </div>
          </div>

        </div>
      </div>
    </div>
  </div>

</div>

<div *ngIf="showPage === 'preStatus'">
  preStatus
</div>


<div *ngIf="showPage === 'noStock'">
  <div style="text-align: center;">
    <h1 style="margin-top: 10%">ไม่มีสินค้า กรุณาติดต่อที่ <a href="0801234567"> 080-123-4567</a></h1>
  </div>
</div>






<div class="modal fade bd-example-modal-lg" id="cartModal" tabindex="-1" role="dialog" aria-labelledby="cartModalTitle"
  aria-hidden="true">
  <div class="modal-dialog modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLongTitle">รถเข็น</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div *ngIf="this.allProductInCart[0]">
        <div class="modal-body">
          <table class="table table-hover">
            <thead>
              <tr>
                <th>#</th>
                <th>ชื่อ</th>
                <th>ขนาด</th>
                <th>ไส้</th>
                <th>จำนวน</th>
                <th>ราคา</th>
                <th> </th>
              </tr>
            </thead>
            <tbody>
              <!-- ngfor -->
              <tr *ngFor="let item of allProductInCart; let i = index">
                <td style="width: 100px; height: 70px;"><img style="width: 100px; height: 70px;" [src]="getImgTobase64(item.p_img)"
                    alt="Card image cap"></td>
                <td>{{item.p_name}}</td>
                <td>{{item.p_size}}</td>
                <td>{{item.mixer}}</td>
                <td>{{item.amount}}</td>
                <td>{{item.sumPrice}}</td>
                <td><button type="button" class="btn btn-danger" (click)="deleteProductInCart(item)">ลบ</button></td>
              </tr>
              <tr>
                <td> </td>
                <td> </td>
                <td> </td>
                <td> </td>
                <td> </td>
                <td>
                  <h6>รวมทั้งหมด ราคา : </h6>
                </td>
                <td>
                  <div style="float:right;">
                    <h6> {{sumNetpay}} บาท</h6>
                  </div>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-dismiss="modal">ปิด</button>
          <button type="button" class="btn btn-primary" (click)="confirmPreOrder()">ยืนยันการสั่งซื้อ</button>
        </div>
      </div>
      <div *ngIf="this.allProductInCart[0] == null" style="text-align: center;margin: 15px;">
        <h1>คุณยังไม่มีสินค้าในรถเข็น</h1>
      </div>
    </div>
  </div>
</div>
